<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Поиск песни</title>

  <!-- Шрифт заголовка -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #0b1220;
      --panel: #0f1724;
      --card: #0e1624;
      --muted: #9aa6b2;
      --accent: #2AABEE;
      --accent-strong: #1B9EDC;
      --text: #e6f0f6;
      --shadow: 0 8px 26px rgba(3,6,12,0.6);
      font-family: 'Montserrat', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body { height:100%; margin:0; background: linear-gradient(180deg,#071021 0%, #071827 100%); color:var(--text); -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale; }
    .app { padding:20px; max-width:820px; margin:20px auto; }

    /* Заголовок по центру */
    header { text-align:center; margin-bottom:18px; }
    header h1 { margin:0; font-size:28px; font-weight:700; letter-spacing:-0.02em; color:var(--text); }
    header p.lead { margin:6px 0 0; color:var(--muted); font-size:13px; }

    /* Поисковая строка — единый блок, скругление 50px */
    .search-row { display:flex; justify-content:center; margin-bottom:18px; }
    .search-pill {
      display:flex;
      align-items:center;
      width:100%;
      max-width:720px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.04);
      padding:6px;
      border-radius: 50px; /* <— по запросу: фиксированное скругление */
      box-shadow: var(--shadow);
      height:56px;
      gap:8px;
    }
    .search-pill input[type="text"]{
      flex:1;
      background:transparent;
      border:0;
      outline:none;
      color:var(--text);
      font-size:15px;
      padding:8px 12px;
      border-radius: 50px; /* чтобы сам input тоже был плавный */
      min-width:0;
    }
    .search-pill button{
      width:56px;
      height:56px;
      border:0;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      background: linear-gradient(180deg,var(--accent),var(--accent-strong));
      color:white;
      border-radius: 50px; /* круглая кнопка через фиксированный радиус */
      box-shadow: 0 6px 18px rgba(26,150,200,0.18);
    }
    .search-pill button svg{
      width:22px;
      height:22px;
      stroke: currentColor;
    }

    /* Карточки результатов */
    .track-card { display:flex; align-items:center; background:var(--card); border-radius:12px; padding:10px; margin-top:12px; box-shadow: 0 6px 18px rgba(2,6,12,0.6); }
    .cover-img { width:56px; height:56px; border-radius:10px; object-fit:cover; margin-right:12px; flex-shrink:0; background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); }
    .track-info { flex:1; overflow:hidden; }
    .track-title { font-size:16px; font-weight:700; margin:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; color:var(--text); }
    .track-sub { font-size:13px; color:var(--muted); margin:6px 0 0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

    .empty { color:var(--muted); margin-top:8px; }

    @media (max-width:480px){
      header h1 { font-size:20px; }
      .search-pill { height:48px; }
      .search-pill button, .search-pill input[type="text"]{ height:48px; }
      .cover-img { width:48px; height:48px; border-radius:8px; }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Поиск Yandex Music Download</h1>
      <p class="lead">Найдите трек</p>
    </header>

    <div class="search-row">
      <form method="get" action="#" onsubmit="
        event.preventDefault();
        const q=encodeURIComponent(this.search_text.value.trim());
        if(q) window.location.href='/' + q + '/';
      " style="width:100%;">
        <div class="search-pill">
          <input type="text" name="search_text" placeholder="Название песни или исполнитель" required autocomplete="off">
          <button type="submit" title="Искать" aria-label="Искать">
            <!-- SVG: иконка лупы (Lucide) -->
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.3-4.3"></path>
            </svg>
          </button>
        </div>
      </form>
    </div>

    {% if error %}
      <p style="color:#ffb7b7;">Ошибка: {{ error }}</p>
    {% endif %}

    {% for track in tracks %}
      <div class="track-card">
        {% if track.cover_url %}
          <img src="{{ track.cover_url }}" alt="Обложка" class="cover-img">
        {% else %}
          <div class="cover-img" aria-hidden="true"></div>
        {% endif %}
        <div class="track-info">
          <p class="track-title">{{ track.title }}</p>
          <p class="track-sub">
            {{ track.artists }}
            {% if track.album and track.album != track.title %} · {{ track.album }}{% endif %}
          </p>
        </div>
      </div>
    {% empty %}
      <p class="empty">Ничего не найдено.</p>
    {% endfor %}
  </div>
</body>
</html>
